<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第 20 章 Media-Dependent 风格 Media-Dependent Styles | 《CSS 权威指南 4th》中文翻译</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/doc/cssdg-4th/assets/css/0.styles.e8f1f0f6.css" as="style"><link rel="preload" href="/doc/cssdg-4th/assets/js/app.22e1f5fa.js" as="script"><link rel="preload" href="/doc/cssdg-4th/assets/js/3.44e73508.js" as="script"><link rel="preload" href="/doc/cssdg-4th/assets/js/25.d563b6d1.js" as="script"><link rel="preload" href="/doc/cssdg-4th/assets/js/7.dcfb28a5.js" as="script"><link rel="preload" href="/doc/cssdg-4th/assets/js/4.624e3ddb.js" as="script"><link rel="preload" href="/doc/cssdg-4th/assets/js/5.2329b135.js" as="script"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/1.01b3c05a.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/10.c841d699.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/11.a09c9602.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/12.f800ba09.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/13.92484766.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/14.abd90931.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/15.6e3f0bc3.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/16.81a1a48e.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/17.a35d5289.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/18.21a4423f.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/19.fc524d4b.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/20.635f39a6.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/21.3c31dd24.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/22.cc7feeda.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/23.5ff1d084.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/24.61be87eb.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/26.28f9c0cd.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/27.bf526e50.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/28.d01673df.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/29.5abbbb68.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/30.1c040e34.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/31.e4e89fe2.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/32.29e68594.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/6.0e6ff00f.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/8.5c4e7671.js"><link rel="prefetch" href="/doc/cssdg-4th/assets/js/9.cf3651b6.js">
    <link rel="stylesheet" href="/doc/cssdg-4th/assets/css/0.styles.e8f1f0f6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/doc/cssdg-4th/" class="home-link router-link-active"><!----> <span class="site-name">《CSS 权威指南 4th》中文翻译</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/gdut-yy/CSS-The-Definitive-Guide-4th-zh" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/gdut-yy/CSS-The-Definitive-Guide-4th-zh" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/doc/cssdg-4th/" aria-current="page" class="sidebar-link">目录</a></li><li><a href="/doc/cssdg-4th/ch1.html" class="sidebar-link">第 1 章 CSS 和 Documents</a></li><li><a href="/doc/cssdg-4th/ch2.html" class="sidebar-link">第 2 章 选择器 Selectors</a></li><li><a href="/doc/cssdg-4th/ch3.html" class="sidebar-link">第 3 章 特异性和级联 Specificity and the Cascade</a></li><li><a href="/doc/cssdg-4th/ch4.html" class="sidebar-link">第 4 章 值和单位 Values and Units</a></li><li><a href="/doc/cssdg-4th/ch5.html" class="sidebar-link">第 5 章 字体 Fonts</a></li><li><a href="/doc/cssdg-4th/ch6.html" class="sidebar-link">第 6 章 文本属性 Text Properties</a></li><li><a href="/doc/cssdg-4th/ch7.html" class="sidebar-link">第 7 章 基本的视觉格式化 Basic Visual Formatting</a></li><li><a href="/doc/cssdg-4th/ch8.html" class="sidebar-link">第 8 章 Padding, Borders, Outlines 和 Margins</a></li><li><a href="/doc/cssdg-4th/ch9.html" class="sidebar-link">第 9 章 颜色、背景和渐变 Colors, Backgrounds, and Gradients</a></li><li><a href="/doc/cssdg-4th/ch10.html" class="sidebar-link">第 10 章 浮动和形状 Floating and Shapes</a></li><li><a href="/doc/cssdg-4th/ch11.html" class="sidebar-link">第 11 章 定位 Positioning</a></li><li><a href="/doc/cssdg-4th/ch12.html" class="sidebar-link">第 12 章 灵活的框布局 Flexible Box Layout</a></li><li><a href="/doc/cssdg-4th/ch13.html" class="sidebar-link">第 13 章 网格布局 Grid Layout</a></li><li><a href="/doc/cssdg-4th/ch14.html" class="sidebar-link">第 14 章 CSS 中的表格布局 Table Layout in CSS</a></li><li><a href="/doc/cssdg-4th/ch15.html" class="sidebar-link">第 15 章 列表和生成的内容 Lists and Generated Content</a></li><li><a href="/doc/cssdg-4th/ch16.html" class="sidebar-link">第 16 章 转换 Transforms</a></li><li><a href="/doc/cssdg-4th/ch17.html" class="sidebar-link">第 17 章 过渡 Transitions</a></li><li><a href="/doc/cssdg-4th/ch18.html" class="sidebar-link">第 18 章 动画 Animation</a></li><li><a href="/doc/cssdg-4th/ch19.html" class="sidebar-link">第 19 章 过滤器，混合，剪切和掩蔽 Filters, Blending, Clipping, and Masking</a></li><li><a href="/doc/cssdg-4th/ch20.html" aria-current="page" class="active sidebar-link">第 20 章 Media-Dependent 风格 Media-Dependent Styles</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/cssdg-4th/ch20.html#_20-1-defining-media-dependent-styles" class="sidebar-link">20.1 Defining Media-Dependent Styles</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/cssdg-4th/ch20.html#_20-1-1-basic-media-queries" class="sidebar-link">20.1.1 Basic Media Queries</a></li><li class="sidebar-sub-header"><a href="/doc/cssdg-4th/ch20.html#_20-1-2-complex-media-queries" class="sidebar-link">20.1.2 Complex Media Queries</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc/cssdg-4th/ch20.html#_20-2-paged-media" class="sidebar-link">20.2 Paged Media</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/cssdg-4th/ch20.html#_20-2-1-print-styles" class="sidebar-link">20.2.1 Print Styles</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc/cssdg-4th/ch20.html#_20-3-summary" class="sidebar-link">20.3 Summary</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="第-20-章-media-dependent-风格-media-dependent-styles"><a href="#第-20-章-media-dependent-风格-media-dependent-styles" class="header-anchor">#</a> 第 20 章 Media-Dependent 风格 Media-Dependent Styles</h1> <p>A great deal of our CSS work goes into putting content onto screens of various kinds,whether they sit on office desks or rest in the palms of our hands. There is more to the web than screens, though, and even in the part that is screen-centric, there are many different kinds of screens, each with its own constraints. Recognizing this reality, CSS provides a number of tools with which to apply styles in specific media, or in media with specific features.</p> <blockquote><p>我们的很多 CSS 工作都是将内容放到各种屏幕上，无论是放在办公桌上还是放在手掌上。然而，web 不仅仅是屏幕，即使在以屏幕为中心的部分，也有许多不同类型的屏幕，每种屏幕都有自己的约束。认识到这一事实后，CSS 提供了许多工具来在特定媒体或具有特定特性的媒体中应用样式。</p></blockquote> <h2 id="_20-1-defining-media-dependent-styles"><a href="#_20-1-defining-media-dependent-styles" class="header-anchor">#</a> 20.1 Defining Media-Dependent Styles</h2> <p>Thanks to the mechanisms defined in HTML and CSS called <code>media queries</code>, you can restrict any kind of style sheet to a specific medium, such as screen or print, and set of media conditions. These mechanisms allows you to define a combination of media types and parameters such as display size or color depth, to pick two examples. We’ll cover the basic form of these queries before exploring the more complex forms.</p> <blockquote><p>得益于 HTML 和 CSS 中定义的“媒体查询”机制，您可以将任何类型的样式表限制为特定的媒体，如屏幕或打印，以及一组媒体条件。这些机制允许您定义媒体类型和参数(如显示大小或颜色深度)的组合，以选择两个示例。在研究更复杂的表单之前，我们将介绍这些查询的基本形式。</p></blockquote> <h3 id="_20-1-1-basic-media-queries"><a href="#_20-1-1-basic-media-queries" class="header-anchor">#</a> 20.1.1 Basic Media Queries</h3> <p>For HTML-based style sheets, you can impose medium restrictions through the <code>media</code> attribute. This works the same for both the <code>link</code> and <code>style</code> elements:</p> <blockquote><p>对于基于 html 的样式表，可以通过 <code>media</code> 属性施加媒体限制。这同样适用于 <code>link</code> 和 <code>style</code> 元素:</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>print<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>article-print.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>speech<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">body</span> <span class="token punctuation">{</span>
    <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>The <code>media</code> attribute can accept a single medium value or a comma-separated list of values. Thus, to link in a style sheet that should be used in only the <code>screen</code> and <code>speech</code> media, you would write:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
  <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>screen, speech<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>visual.css<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>In a style sheet itself, you can also impose medium restrictions on <code>@import</code> rules:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@import</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>visual.css<span class="token punctuation">)</span></span> screen<span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@import</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>outloud.css<span class="token punctuation">)</span></span> speech<span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@import</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>article-print.css<span class="token punctuation">)</span></span> print<span class="token punctuation">;</span></span>
</code></pre></div><p>Remember that if you don’t add medium information to a style sheet, it will be applied in <code>all</code> media. Therefore, if you want one set of styles to apply only on screen, and another to apply only in print, then you need to add medium information to both style sheets. For example:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
  <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>screen<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>article-screen.css<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>print<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>article-print.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>If you were to remove the <code>media</code> attribute from the first <code>link</code> element in the preceding example, the rules found in the style sheet <code>article-screen.css</code> would be applied in all media.</p> <p>CSS also defines syntax for <code>@media</code> blocks. This allows you define styles for multiple media within the same style sheet. Consider this basic example:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">body</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token atrule"><span class="token rule">@media</span> screen</span> <span class="token punctuation">{</span>
    <span class="token selector">body</span> <span class="token punctuation">{</span>
      <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">h1</span> <span class="token punctuation">{</span>
      <span class="token property">margin-top</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token atrule"><span class="token rule">@media</span> print</span> <span class="token punctuation">{</span>
    <span class="token selector">body</span> <span class="token punctuation">{</span>
      <span class="token property">font-family</span><span class="token punctuation">:</span> serif<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">h1</span> <span class="token punctuation">{</span>
      <span class="token property">margin-top</span><span class="token punctuation">:</span> 2em<span class="token punctuation">;</span>
      <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid silver<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Here we see that in all media, the <code>body</code> element is given a white background and a black foreground by the first rule. This happens because its style sheet, the one defined by the <code>style</code> attribute, has no <code>media</code> attribute and thus defaults to <code>all</code>. Next, a block of rules is provided for the <code>screen</code> medium alone, followed by another block of rules that applies only in the <code>print</code> medium.</p> <p><code>@media</code> blocks can be any size, containing any number of rules. In situations where authors have control over a single style sheet, such as a shared hosting environment or a content management system (CMS) that restricts what users can edit, <code>@media</code> blocks may be the only way to define medium-specific styles. This is also the case in situations where CSS is used to style a document using an XML language that does not contain a <code>media</code> attribute or its equivalent.</p> <p>These are the four most widely recognized media types:</p> <p><code>all</code></p> <p>Use in all presentational media.</p> <p><code>print</code></p> <p>Use when printing the document for sighted users, and also when displaying a print preview of the document.</p> <p><code>screen</code></p> <p>Use when presenting the document in a screen medium like a desktop computer monitor or a handheld device. All web browsers running on such systems are screen-medium user agents.</p> <p><code>speech</code></p> <p>Use in speech synthesizers, screen readers, and other audio renderings of the document.</p> <p>HTML4 defined a list of media types that CSS originally recognized, but most of them have been deprecated and should be avoided. These are <code>aural</code>, <code>braille</code>, <code>embossed</code>, <code>handheld</code>, <code>projection</code>, <code>tty</code>, and <code>tv</code>. If you have old style sheets that use these media types, they should be converted to one of the four recognized media types, if possible.</p> <div class="tip" data-v-29b3da36><div class="left" data-v-29b3da36><img src="./note.png" data-v-29b3da36></div> <div class="right" data-v-29b3da36><p data-v-29b3da36></p> <p data-v-29b3da36>It’s entirely possible that new media types will be added over time, so remember that this limited list may not always be so limited. It’s fairly easy to imagine <code data-v-29b3da36>augmented-reality</code> as a media type, for example, since text in AR displays would likely need to be of higher contrast in order to stand out against the background reality.</p></div></div> <p>It’s possible in some circumstances to combine media types into comma-separated lists, though the rationale for doing so isn’t terribly compelling, given the small number of media types currently available. For example, styles could be restricted to only screen and print media in the following ways:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
  <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>screen, print<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>article.css<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@import</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>article.css<span class="token punctuation">)</span></span> print<span class="token punctuation">,</span> screen<span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@media</span> screen<span class="token punctuation">,</span> print</span> <span class="token punctuation">{</span>
  <span class="token comment">/* styles go here */</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_20-1-2-complex-media-queries"><a href="#_20-1-2-complex-media-queries" class="header-anchor">#</a> 20.1.2 Complex Media Queries</h3> <p>In the previous section, we saw how multiple media types could be chained together with a comma. We might call that a compound media query, because it allows us to address multiple media at once. There is a great deal more to media queries, though: it’s possible to apply styles based not just media types, but also features of those media, such as display size or color depth.</p> <p>This is a great deal of power, and it’s not enough to rely on commas to make it all happen. Thus, CSS introduced the logical operator <code>and</code> to pair media types with features of those media.</p> <p>Let’s see how this plays out in practice. Here are two essentially equivalent ways of applying an external style sheet when rendering the document on a color printer:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>print-color.css<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>print and (color)<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@import</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>print-color.css<span class="token punctuation">)</span></span> print <span class="token keyword">and</span> <span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
</code></pre></div><p>Anywhere a media type can be given, a media query can be constructed. This means that, following on the examples of the previous section, it is possible to list more than one query in a comma-separated list:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>print-color.css<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>print and (color), screen and (color)<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@import</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>print-color.css<span class="token punctuation">)</span></span> print <span class="token keyword">and</span> <span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">,</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
</code></pre></div><p>In a situation where even one of the media queries evaluates to <code>true</code>, the associated style sheet is applied. Thus, given the previous <code>@import</code>, <code>print-color.css</code> will be applied if rendering to a color printer <code>or</code> to a color screen environment. If printing on a blackand-white printer, both queries will evaluate to <code>false</code> and <code>print-color.css</code> will not be applied to the document. The same holds true in a grayscale screen environment, any speech media environment, and so forth.</p> <p>Each media descriptor is composed of a media type and one or more listed media features, with each media feature descriptor is enclosed in parentheses. If no media type is provided, then it is assumed to be <code>all</code>, which makes the following two examples equivalent:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@media</span> all <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 96dpi<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>…<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 960dpi<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>…<span class="token punctuation">}</span>
</code></pre></div><p>Generally speaking, a media feature descriptor is formatted like a property-value pair in CSS, only enclosed by parentheses. There are a few differences, most notably that some features can be specified without an accompanying value. For example, any color-based medium will be matched using <code>(color)</code>, whereas any color medium using a 16-bit color depth is matched using <code>(color: 16)</code>. In effect, the use of a descriptor without a value is a true/false test for that descriptor: <code>(color)</code> means “is this medium in color?”</p> <p>Multiple feature descriptors can be linked with the <code>and</code> logical keyword. In fact, there are two logical keywords in media queries:</p> <p><code>and</code></p> <p>Links together two or more media features in such a way that all of them must be true for the query to be true. For example, <code>(color) and (orientation: land scape) and (min-device-width: 800px)</code> means that all three conditions must be satisfied: if the media environment has color, is in landscape orientation, and the device’s display is at least 800 pixels wide, then the style sheet is used.</p> <p><code>not</code></p> <p>Negates the entire query so that if all of the conditions are true, then the style sheet is not applied. For example, <code>not (color) and (orientation: landscape) and (min-device-width: 800px)</code> means that if the three conditions are satisfied, the statement is negated. Thus, if the media environment has color, is in landscape orientation, and the device’s display is at least 800 pixels wide, then the style sheet is <code>not</code> used. In all other cases, it will be used.</p> <p>Note that the <code>not</code> keyword can only be used at the beginning of a media query. It is not presently legal to write something like <code>(color) and not (min-device-width: 800px)</code>. In such cases, the query will be ignored. Note also that browsers too old to understand media queries will always skip a style sheet whose media descriptor starts with <code>not</code>.</p> <p>An example of how all this plays out is shown in Figure 20-1, which is the result of the following styles:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@media</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 72dpi<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.cl01</span> <span class="token punctuation">{</span>
    <span class="token property">font-style</span><span class="token punctuation">:</span> italic<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 32767dpi<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.cl02</span> <span class="token punctuation">{</span>
    <span class="token property">font-style</span><span class="token punctuation">:</span> italic<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token keyword">not</span> print</span> <span class="token punctuation">{</span>
  <span class="token selector">.cl03</span> <span class="token punctuation">{</span>
    <span class="token property">font-style</span><span class="token punctuation">:</span> italic<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token keyword">not</span> print <span class="token keyword">and</span> <span class="token punctuation">(</span>grayscale<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.cl04</span> <span class="token punctuation">{</span>
    <span class="token property">font-style</span><span class="token punctuation">:</span> italic<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="figure" data-v-87bdcbd6><div class="fg" data-v-87bdcbd6><div class="fgimg" data-v-87bdcbd6><!----> <img src="./figures/ch20/fg20-1.png" data-v-87bdcbd6></div></div> <div class="fgtitle" data-v-87bdcbd6><p data-v-87bdcbd6>
      图 20-1：
      Logical operators in media queries</p></div></div> <p>First, bear in mind that, even though you may be reading this on printed paper, the actual image in Figure 20-1 was generated with a screen-medium browser (Firefox Nightly, as it happens) displaying an HTML document with the previous CSS applied to it. So everything you see there was operating under a <code>screen</code> medium.</p> <p>The first line is italicized because the screen on which the file was displayed had a resolution equal to or greater than than 72 dots per inch. Its resolution was not, however, <code>32767dpi</code> or higher, so the second media block is skipped and thus the second line stays un-italicized. The third line is italicized because, being a screen display, it was <code>not print</code>. The last line is italicized because it was either not print or not grayscale—in this case, not grayscale.</p> <p>There is no OR keyword for use in media queries. Instead, the commas that separate a list of queries serve the function of an OR—<code>screen, print</code> means “apply if the media is screen or print.” Therefore, instead of <code>screen and (max-color: 2) or (monochrome)</code>, which is invalid and thus ignored, you need to write <code>screen and (max-color: 2), screen and (monochrome)</code>.</p> <p>There is one more keyword, <code>only</code>, which is designed to create deliberate backward incompatibility. Yes, really.</p> <p><code>only</code></p> <p>Used to hide a style sheet from browsers too old to understand media queries. For example, to apply a style sheet in all media, but only in those browsers that understand media queries, you write something like <code>@import url(new.css)</code> only all. In browsers that <code>do</code> understand media queries, the <code>only</code> keyword is ignored and the style sheet is applied. In browsers that do not understand media queries, the <code>only</code> keyword creates an apparent media type of <code>only all</code>, which is not valid. Thus, the style sheet is not applied in such browsers. Note that the <code>only</code> keyword can only be used at the beginning of a media query.</p> <h4 id="media-feature-descriptors"><a href="#media-feature-descriptors" class="header-anchor">#</a> Media feature descriptors</h4> <p>So far we’ve seen a number of media feature descriptors in the examples, but not a complete list of the possible descriptors and their values. Let us fix that now! Note that none of the following values can be negative, and remember that feature descriptors are always enclosed in parentheses.</p> <p>Descriptors: <code>width</code>, <code>min-width</code>, <code>max-width</code></p> <p><code>Values: &lt;length&gt;</code></p> <p>Refers to the width of the display area of the user agent. In a screen-media web browser, this is the width of the viewport plus any scrollbars. In paged media, this is the width of the page box, which is the area of the page in which content is rendered. Thus, <code>(min-width: 850px)</code> applies when the viewport is greater than or equal to 850 pixels wide.</p> <p>Descriptors: <code>height</code>, <code>min-height</code>, <code>max-height</code></p> <p><code>Values: &lt;length&gt;</code></p> <p>Refers to the height of the display area of the user agent. In a screen-media web browser, this is the height of the viewport plus any scrollbars. In paged media, this is the height of the page box. Thus, (height: 567px) applies when the viewport’s height is precisely 567 pixels tall.</p> <p>Descriptors: <code>device-width</code>, <code>min-device-width</code>, <code>max-device-width</code></p> <p><code>Values: &lt;length&gt;</code></p> <p>Refers to the width of the complete rendering area of the output device. In screen media, this is the width of the screen; i.e., a handheld device screen’s or desktop monitor’s horizontal measurement. In paged media, this is the width of the page itself. Thus, <code>(max-device-width: 1200px)</code> applies when the device’s output area is less or equal to than 1,200 pixels wide.</p> <p>Descriptors: <code>device-height</code>, <code>min-device-height</code>, <code>max-device-height</code></p> <p><code>Values: &lt;length&gt;</code></p> <p>Refers to the height of the complete rendering area of the output device. In screen media, this is the height of the screen; i.e., a handheld device screen’s or desktop monitor’s vertical measurement. In paged media, this is the height of the page itself. Thus, <code>(max-device-height: 400px)</code> applies when the device’s output area is less than or equal to 400 pixels tall.</p> <p>Descriptors: <code>aspect-ratio</code>, <code>min-aspect-ratio</code>, <code>max-aspect-ratio</code></p> <p><code>Values: &lt;ratio&gt;</code></p> <p>Refers to the ratio that results from comparing the <code>width</code> media feature to the <code>height</code> media feature (see the definition of <code>&lt;ratio&gt;</code> in the next section). Thus, <code>(min-aspect-ratio: 2/1)</code> applies to any viewport whose width-toheight ratio is at least 2:1.</p> <p>Descriptors: <code>device-aspect-ratio</code>, <code>min-device-aspect-ratio</code>, <code>max-deviceaspect-ratio</code></p> <p><code>Values: &lt;ratio&gt;</code></p> <p>Refers to the ratio that results from comparing the <code>device-width</code> media feature to the <code>device-height</code> media feature (see the definition of <code>&lt;ratio&gt;</code> in the next section). Thus, <code>(device-aspect-ratio: 16/9)</code> applies to any output device whose display area width-to-height is exactly <code>16:9</code>.</p> <p>Descriptors: <code>color</code>, <code>min-color</code>, <code>max-color</code></p> <p><code>Values: &lt;integer&gt;</code></p> <p>Refers to the presence of color-display capability in the output device, with an <code>optional</code> number value representing the number of bits used in each color components. Thus, <code>(color)</code> applies to any device with any color depth at all, whereas <code>(min-color: 4)</code> means there must be at least four bits used per color component. Any device that does not support color will return <code>0</code>.</p> <p>Descriptors: <code>color-index</code>, <code>min-color-index</code>, <code>max-color-index</code></p> <p><code>Values: &lt;integer&gt;</code></p> <p>Refers to the total number of colors available in the output device’s color lookup table. Any device that does not use a color lookup table will return <code>0</code>. Thus, <code>(min-color-index: 256)</code> applies to any device with a minimum of 256 colors available.</p> <p>Descriptors: <code>monochrome</code>, <code>min-monochrome</code>, <code>max-monochrome</code></p> <p><code>Values: &lt;integer&gt;</code></p> <p>Refers to the presence of a monochrome display, with an <code>optional</code> number of bits-per-pixel in the output device’s frame buffer. Any device that is not monochrome will return <code>0</code>. Thus, <code>(monochrome)</code> applies to any monochrome output device, whereas <code>(min-monochrome: 2)</code> means any monochrome output device with a minimum of 2 bits per pixel in the frame buffer.</p> <p>Descriptors: <code>resolution</code>, <code>min-resolution</code>, <code>max-resolution</code></p> <p><code>Values: &lt;resolution&gt;</code></p> <p>Refers to the resolution of the output device in terms of pixel density, measured in either dots per inch (dpi) or dots per centimeter (dpcm); see the definition of <code>&lt;resolution&gt;</code> in the next section for details. If an output device has pixels that are not square, then the least dense axis is used; for example, if a device is 100 dpcm along one axis and 120 dpcm along the other, then <code>100</code> is the value returned. Additionally, in such non-square cases, a bare <code>resolution</code> feature query—that is, one without a value—can never match (though
<code>min-resolution</code> and <code>max-resolution</code> can). Note that resolution values must not only be non-negative, but also nonzero.</p> <p>Descriptors: orientation</p> <p><code>Values: portrait | landscape</code></p> <p>Refers to the orientation of the user agent’s display area, where portrait is returned if the media feature height is equal to or greater than the media feature width. Otherwise, the result is landscape.</p> <p>Descriptor: scan</p> <p><code>Values: progressive | interlace</code></p> <p>Refers to the scanning process used in an output device. interlace is the type generally used in CRT and some plasma displays. progressive is more common, being the type of scanning used in most modern displays.</p> <p>Descriptor: grid</p> <p><code>Values: 0 | 1</code></p> <p>Refers to the presence (or absence) of a grid-based output device, such as a TTY terminal. A grid-based device will return 1; otherwise, 0 is returned. This feature descriptor can be used in place of the old tty media descriptor. New value types</p> <p>There are two new value types introduced by media queries, and which (as of early 2017. are not used in any other context. These types are used in conjunction with specific media features, which are explained in the previous sections:</p> <p><code>&lt;ratio&gt;</code></p> <p>A ratio value is two positive <code>&lt;integer&gt;</code> values separated by a solidus (/) and optional whitespace. The first value refers to the width, and the second to the height. Thus, to express a height-to-width ratio of 16:9, you can write 16/9 or 16 / 9. As of this writing, there is no facility to express a ratio as a single real number, nor to use a colon separator instead of a solidus.</p> <p><code>&lt;resolution&gt;</code></p> <p>A resolution value is a positive <code>&lt;integer&gt;</code> followed by either of the unit identifiers dpi or dpcm. In CSS terms, a “dot” is any display unit, the most familiar of which is the pixel. As usual, whitespace is not permitted between the <code>&lt;integer&gt;</code> and the identifier. Therefore, a display whose display has exactly 150 pixels (dots) per inch is matched with 150dpi.</p> <h4 id="responsive-styling"><a href="#responsive-styling" class="header-anchor">#</a> Responsive styling</h4> <p>Media queries are, at least as of early 2017, the foundation on which the practice of responsive web design is built. By applying different sets of rules depending on the display environment, it’s possible to marry mobile-friendly and desktop-friendly styles into a single style sheet.</p> <p>Those terms were put in quote because, as you may have seen in your own life, the lines between what’s mobile and what’s desktop are blurred. A laptop with a touchsensitive screen that folds all the way back can act as both a tablet and a laptop, for example. CSS doesn’t (yet) have a way of detecting whether or not a hinge is open past a certain point, nor whether the device is held in hand or sitting on a flat surface. Instead, inferences are drawn from aspects of the media environment, like display size or display orientation.</p> <p>A fairly common pattern in responsive design is to define breakpoints for each @media block. This often takes the form of certain pixel widths, like this:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* …common styles here… */</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 400px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* …small-screen styles here… */</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 401px<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 1000px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* …medium-screen styles here… */</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 1001px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* …big-screen styles here… */</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This is often sufficient. It does make certain assumptions about what a device can display and how it will report that, however. For example, the iPhone 6 Plus had a resolution of 1,242 × 2,208, which it downsampled to 1,080 × 1,920. Even at the downsampled resolution, that’s enough pixels across to qualify for big-screen styles in the previous example.</p> <p>But wait! The iPhone 6 Plus also maintained an internal coordinate system of points which measured 414 × 736. If it decided to use those as its definition of pixels, which would be entirely valid, then it would only get the small-screen styles. The point here isn’t to single out the iPhone 6 Plus as uniquely bad, which it wasn’t, but to illustrate the uncertainties of relying on pixel-based media queries. Browser makers have gone to some effort to make their browsers behave with some semblance of sanity, but never quite as much as we’d like, and you never know when a new device’s assumptions will clash with your own.</p> <p>There are other methods available, though they come with their own uncertainties. Instead of pixels, you might try em-based measures, something like this:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* …common styles here… */</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 20em<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* …small-screen styles here… */</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 20.01em<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 50em<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* …medium-screen styles here… */</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 50.01em<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* …big-screen styles here… */</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This ties the breakpoints to text display size rather than pixels, which is somewhat more robust. This isn’t perfect either, though: it relies on a sensible approach to determining the em width of, say, a smartphone. It also directly relies on the actual font-family and size used by the device, which varies from one device to another. Here’s another seemingly simple query set with potentially surprising results:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* …common styles here… */</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">orientation</span><span class="token punctuation">:</span> landscape<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* …wider-than-taller styles here… */</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">orientation</span><span class="token punctuation">:</span> portrait<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/* …taller-than-wider styles here… */</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This feels like a good way to tell if a smartphone is in use: after all, most of them are taller than they are wide, and most people don’t turn them sideways to read. The wrinkle is that the orientation feature refers to the height and width descriptors; that is, orientation is portrait is height is equal to or larger than width. Not device-height and device-width, but height and width, which refer to the display area of the user agent.</p> <p>That means a desktop browser window whose display area (the part inside the browser Chrome) is taller than it is wide, or even perfectly square, will get the portrait styles. So if you assume “portrait equals smartphone,” some of your desktop users could get a surprise.</p> <p>The basic point here is: responsive styling is powerful, and like any powerful tool, it requires a fair amount of thought and care in its use. Carefully considering the implications of each combination of feature queries is the minimum requirement for successful responsiveness.</p> <h2 id="_20-2-paged-media"><a href="#_20-2-paged-media" class="header-anchor">#</a> 20.2 Paged Media</h2> <p>In CSS terms, a paged medium is any medium where a document’s presentation is handled as a series of discrete “pages.” This is different than the screen, which is a continuous medium: documents are presented as a single, scrollable “page.” An analog example of a continuous medium is a papyrus scroll. Printed material, such as books, magazines, and laser printouts, are all paged media. So too are slideshows, where a series of slides are shown one at a time. Each slide is a “page” in CSS terms.</p> <h3 id="_20-2-1-print-styles"><a href="#_20-2-1-print-styles" class="header-anchor">#</a> 20.2.1 Print Styles</h3> <p>Even in the paperless future, the most commonly encountered paged medium is a printout of some document—a web page, a word-processing document, a spread‐sheet, or something else that has been committed to the thin wafers of a dead tree. Authors can do a number of things to make printouts of their documents more pleasing for the user, from affecting page-breaking to creating styles meant specifically for print.</p> <p>Note that print styles would also be applied to document display in a print preview mode. Thus, it’s possible in some circumstances to see print styles on a monitor.</p> <h4 id="differences-between-screen-and-print"><a href="#differences-between-screen-and-print" class="header-anchor">#</a> Differences between screen and print</h4> <p>Beyond the obvious physical differences, there are a number of stylistic differences between screen and print design. The most basic involves font choices. Most designers will tell you that sans-serif fonts are best suited for screen design, but serif fonts are more readable in print. Thus, you might set up a print style sheet that uses Times instead of Verdana for the text in your document.</p> <p>Another major difference involves font sizing. If you’ve spent any time at all doing web design, you’ve probably heard again and again (and again) that points are a horrible choice for font sizing on the web. This is basically true, especially if you want your text to be consistently sized between browsers and operating systems. However, print design is not web design any more than web design is print design. Using points, or even centimeters or picas, is perfectly OK in print design because printing devices know the physical size of their output area. If a printer has been loaded with 8.5 × 11 inch paper, then it knows it has a printing area that will fit within the edges of a piece of paper. It also knows how many dots there are in an inch, since it knows the dpi it’s capable of generating. This means that it can cope with physical-world length units like points.</p> <p>Many a print style sheet has started with:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">font</span><span class="token punctuation">:</span> 12pt <span class="token string">&quot;Times New Roman&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;TimesNR&quot;</span><span class="token punctuation">,</span> Times<span class="token punctuation">,</span> serif<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It’s so traditional, it just might bring a tear of joy to the eye of a graphic artist reading over your shoulder. But make sure they understand that points are acceptable only because of the nature of the print medium—they’re still not good for web design. Alternatively, the lack of backgrounds in most printouts might bring a tear of frustration to that designer’s eye. In order to save users ink, most web browsers are preconfigured not to print background colors and images. If the user wants to see those backgrounds in the printout, they have to change an option somewhere in the preferences.</p> <p>CSS can’t do anything to force the printing of backgrounds. However, you can use a print style sheet to make backgrounds unnecessary. For example, you might include this rule in your print style sheet:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">*</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> black <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> transparent <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This will do its utmost to ensure all of your elements print out as black text and remove any backgrounds you might have assigned in an all-medium style sheet. It also makes sure that if you have a web design that puts yellow text on a dark gray background, a user with a color printer won’t get yellow text on a white piece of paper.</p> <p>One other difference between paged media and continuous media is that multicolumn layouts are even harder to use in paged media. Suppose you have an article where the text has been formatted as two columns. In a printout, the left side of each page will contain the first column, and the right side the second. This would force the user to read the left side of every page, then go back to the beginning of the printout and read the right side of every page. This is annoying enough on the web, but on paper it’s much worse.</p> <p>One solution is to use CSS for laying out your two columns (by floating them, perhaps) and then writing a print style sheet that restores the content to a single column. Thus, you might write something like this for the screen style sheet:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">div#leftcol</span> <span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 45%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">div#rightcol</span> <span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 45%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Then in your print style sheet, you would write:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">div#leftcol,
div#rightcol</span> <span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Alternatively, in user agents that support it, you might define actual multicolumn layout for both screen and print, and trust the user agents to do the right thing. We could spend an entire chapter on the details of print design, but that really isn’t the purpose of this book. Let’s start exploring the details of paged-media CSS and leave the design discussions for another book.</p> <h4 id="defining-the-page-size"><a href="#defining-the-page-size" class="header-anchor">#</a> Defining the page size</h4> <p>In much the same way as it defines the element box, CSS2 defines a page box that describes the components of a page. A page box is composed of basically two regions:</p> <ul><li>The page area, which is the portion of the page where the content is laid out. This is roughly analogous to the content area of a normal element box, to the extent that the edges of the page area act as the initial containing block for layout within a page.</li> <li>The margin area, which surrounds the page area.</li></ul> <p>The page box model is illustrated in Figure 20-2.</p> <div class="figure" data-v-87bdcbd6><div class="fg" data-v-87bdcbd6><div class="fgimg" data-v-87bdcbd6><!----> <img src="./figures/ch20/fg20-2.png" data-v-87bdcbd6></div></div> <div class="fgtitle" data-v-87bdcbd6><p data-v-87bdcbd6>
      图 20-2：
      The page box</p></div></div> <p>The @page block is the method by which settings are made, and the size property is used to define the actual dimensions of the page box. Here’s a simple example:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span></span> <span class="token punctuation">{</span>
  <span class="token property">size</span><span class="token punctuation">:</span> 7.5in 10in<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0.5in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>@page</code> is a block like <code>@media</code> is a block, and within it can contain any set of styles. One of them, <code>size</code>, only makes sense in the context of an <code>@page</code> block.</p> <div class="tip" data-v-29b3da36><div class="left" data-v-29b3da36><img src="./warn.png" data-v-29b3da36></div> <div class="right" data-v-29b3da36><p data-v-29b3da36></p> <p data-v-29b3da36>As of early 2017, only Chrome and Opera supported <code data-v-29b3da36>size</code>, the latter with some oddities in its calculation of dimensions.</p></div></div> <div class="card" data-v-91de34ec><!----> <!----> <div class="card__property" data-v-91de34ec></div></div> <p>This property is used to define the size of the page area. The value landscape is meant to cause the layout to be rotated 90 degrees, whereas portrait is the normal orientation for Western-language printing. Thus, an author could cause a document to be printed sideways by declaring the following, with the result shown in Figure 20-3:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span></span> <span class="token punctuation">{</span>
  <span class="token property">size</span><span class="token punctuation">:</span> landscape<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="figure" data-v-87bdcbd6><div class="fg" data-v-87bdcbd6><div class="fgimg" data-v-87bdcbd6><!----> <img src="./figures/ch20/fg20-3.png" data-v-87bdcbd6></div></div> <div class="fgtitle" data-v-87bdcbd6><p data-v-87bdcbd6>
      图 20-3：
      Landscape page sizing</p></div></div> <p>In addition to landscape and portrait, there are a number of predefined page-size keywords available. These are summarized in Table 20-1.</p> <p>// T20-1</p> <p>Any one of the keywords can be used to declare a page size. The following defines a page to be JIS B5 size:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span></span> <span class="token punctuation">{</span>
  <span class="token property">size</span><span class="token punctuation">:</span> JIS-B5<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>These keywords can be combined with the landscape and portrait keywords; thus, to define landscape-oriented North American legal pages, the following is used:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span></span> <span class="token punctuation">{</span>
  <span class="token property">size</span><span class="token punctuation">:</span> landscape legal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Besides using keywords, it’s also possible to define page sizes using length units. In such cases, the width is given first, and then the height. Therefore, the following defines a page area 8 inches wide by 10 inches tall:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span></span> <span class="token punctuation">{</span>
  <span class="token property">size</span><span class="token punctuation">:</span> 8in 10in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The defined area is usually centered within the physical page, with equal amounts of whitespace on each side. If the defined size is larger than the printable area of the page, then the user agent has to decide what to do to resolve the situation. There is no defined behavior here, so it’s really dealer’s choice.</p> <h4 id="page-margins-and-padding"><a href="#page-margins-and-padding" class="header-anchor">#</a> Page margins and padding</h4> <p>Related to size, CSS includes the ability to style the margin area of the page box. If you want to make sure that only a small bit at the center of every 8.5 × 11 inch page is used to print, you could write:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span></span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 3.75in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This would leave a printing area 1 inch wide by 3.5 inches tall. It is possible to use the length units em and ex to describe either the margin area or the page area, at least in theory. The size used is taken from the page context’s font, which is to say, the base font size used for the content displayed on the page.</p> <div class="tip" data-v-29b3da36><div class="left" data-v-29b3da36><img src="./warn.png" data-v-29b3da36></div> <div class="right" data-v-29b3da36><p data-v-29b3da36></p> <p data-v-29b3da36>The ability to set page margins and padding was barely supported as of early 2017. In Chrome, for example, attempting to define page margins caused the entire @page block to be ignored.</p></div></div> <h4 id="selecting-page-types"><a href="#selecting-page-types" class="header-anchor">#</a> Selecting page types</h4> <p>CSS2 offers the ability to create different page types using named @page rules. Let’s say you have a document on astronomy that is several pages long, and in the middle of it, there is a fairly wide table containing a list of the physical characteristics of all the moons of Saturn. You want to print out the text in portrait mode, but the table needs to be landscape. Here’s how you’d start:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span> normal</span> <span class="token punctuation">{</span>
  <span class="token property">size</span><span class="token punctuation">:</span> portrait<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 1in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@page</span> rotate</span> <span class="token punctuation">{</span>
  <span class="token property">size</span><span class="token punctuation">:</span> landscape<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0.5in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now you just need to apply these page types as needed. The table of Saturn’s moons has an id of moon-data, so you write the following rules:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">page</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">table#moon-data</span> <span class="token punctuation">{</span>
  <span class="token property">page</span><span class="token punctuation">:</span> rotate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This causes the table to be printed landscape, but the rest of the document to be in portrait orientation. The property page is what makes this possible.</p> <div class="card" data-v-91de34ec><!----> <!----> <div class="card__property" data-v-91de34ec></div></div> <p>As you can see from looking at the value definition, the whole reason page exists is to let you assign named page types to various elements in your document.</p> <div class="tip" data-v-29b3da36><div class="left" data-v-29b3da36><img src="./warn.png" data-v-29b3da36></div> <div class="right" data-v-29b3da36><p data-v-29b3da36></p> <p data-v-29b3da36>As of early 2017, there was little if any support for named pages.</p></div></div> <p>There are more generic page types that you can address through special pseudoclasses. :first lets you apply special styles to the first page in the document. For example, you might want to give the first page a larger top margin than other pages.</p> <p>Here’s how:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span></span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 3cm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@page</span> <span class="token punctuation">:</span>first</span> <span class="token punctuation">{</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 6cm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This will yield a 3 cm margin on all pages, with the exception of a 6 cm top margin on the first page.</p> <p>In addition to styling the first page, you can also style left and right pages, emulating the pages to the left and right of a book’s spine. You can style these differently using :left and :right. For example:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@page</span> <span class="token punctuation">:</span>left</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 3cm<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 5cm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@page</span> <span class="token punctuation">:</span>right</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 5cm<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 3cm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>These rules will have the effect of putting larger margins between the content of the left and right pages, on the sides where the spine of a book would be. This is a common practice when pages are to be bound together into a book of some type.</p> <div class="tip" data-v-29b3da36><div class="left" data-v-29b3da36><img src="./warn.png" data-v-29b3da36></div> <div class="right" data-v-29b3da36><p data-v-29b3da36></p> <p data-v-29b3da36>As of early 2017, there was little if any support for <code data-v-29b3da36>:first</code>, <code data-v-29b3da36>:left</code>, or <code data-v-29b3da36>:right</code>.</p></div></div> <h4 id="page-breaking"><a href="#page-breaking" class="header-anchor">#</a> Page-breaking</h4> <p>In a paged medium, it’s a good idea to exert some influence over how page breaks are placed. You can affect page breaking using the properties page-break-before and page-break-after, both of which accept the same set of values.</p> <div class="card" data-v-91de34ec><!----> <!----> <div class="card__property" data-v-91de34ec></div></div> <p>The default value of auto means that a page break is not forced to come before or after an element. This is the same as any normal printout. always causes a page break to be placed before (or after) the styled element.</p> <p>For example, assume a situation where the page title is an h1 element, and the section titles are all h2 elements. We might want a page break right before the beginning of each section of a document and after the document title. This would result in the following rules, illustrated in Figure 20-4:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">page-break-after</span><span class="token punctuation">:</span> always<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">h2</span> <span class="token punctuation">{</span>
  <span class="token property">page-break-before</span><span class="token punctuation">:</span> always<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="figure" data-v-87bdcbd6><div class="fg" data-v-87bdcbd6><div class="fgimg" data-v-87bdcbd6><!----> <img src="./figures/ch20/fg20-4.png" data-v-87bdcbd6></div></div> <div class="fgtitle" data-v-87bdcbd6><p data-v-87bdcbd6>
      图 20-4：
      Inserting page breaks</p></div></div> <p>If you want the document title to be centered in its page, then we’d add rules to that effect. Since we don’t, we just get a very straightforward rendering of each page. The values left and right operate in the same manner as always except they further define the type of page on which printing can resume. Consider the following:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">h2</span> <span class="token punctuation">{</span>
  <span class="token property">page-break-before</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This will force every h2 element to be preceded by enough page breaks so that the h2 will be printed at the top of a left page—that is, a page surface that would appear to the left of a spine if the output were bound. In double-sided printing, this would mean printing on the back of a piece of paper.</p> <p>So let’s assume that, in printing, the element just before an h2 is printed on a right page. The previous rule would cause a single page break to be inserted before the h2, thus pushing it to the next page. If the next h2 is preceded by an element on a left page, however, the h2 would be preceded by two page breaks, thus placing it at the top of the next left page. The right page between the two would be intentionally left blank. The value right has the same basic effect, except it forces an element to be printed at the top of a right page preceded by either one or two page breaks.</p> <p>The companion to always is avoid, which directs the user agent to do its best to avoid placing a page break either before or after an element. To extend the previous example, suppose you have subsections whose titles are h3 elements. You want to keep these titles together with the text that follows them, so you want to avoid a page break following an h3 whenever possible:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">h3</span> <span class="token punctuation">{</span>
  <span class="token property">page-break-after</span><span class="token punctuation">:</span> avoid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Note, though, that the value is called avoid, not never. There is no way to absolutely guarantee that a page break will never be inserted before or after a given element.</p> <p>Consider the following:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">img</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 9.5in<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 8in<span class="token punctuation">;</span>
  <span class="token property">page-break-before</span><span class="token punctuation">:</span> avoid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">h4</span> <span class="token punctuation">{</span>
  <span class="token property">page-break-after</span><span class="token punctuation">:</span> avoid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">h4 + img</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 10.5in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now, suppose further that you have a situation where an h4 is placed between two images, and its height calculates to be half an inch. Each image will have to be printed on a separate page, but there are only two places the h4 can go: at the bottom of the page holding the first element, or on the page after it. If it’s placed after the first image, then it has to be followed by a page break, since there’s no room for the second image to follow it.</p> <p>On the other hand, if the h4 is placed on a new page following the first image, then there won’t be room on that same page for the second image. So, again, there will be a page break after the h4. And, in either case, at least one image, if not both, will be preceded by a page break. There’s only so much the user agent can do, given a situation like this one.</p> <p>Situations such as these are rare, but they can happen—for example, in a case where a document contains nothing but tables preceded by headings. There may be cases where tables print in such a way that they force a heading element to be followed by a page break, even though the author requested such break placement be avoided.</p> <p>The same sorts of issues can arise with the other page-break property, page-breakinside. Its possible values are more limited than those of its cousins.</p> <div class="card" data-v-91de34ec><!----> <!----> <div class="card__property" data-v-91de34ec></div></div> <p>With page-break-inside, you pretty much have one option other than the default: you can request that a user agent try to avoid placing page breaks within an element. If you have a series of aside divisions, and you don’t want them broken across two pages, you could declare:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">div.aside</span> <span class="token punctuation">{</span>
  <span class="token property">page-break-inside</span><span class="token punctuation">:</span> avoid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Again, this is a suggestion more than an actual rule. If an aside turns out to be longer than a page, the user agent can’t help but place a page break inside the element.</p> <h4 id="orphans-and-widows"><a href="#orphans-and-widows" class="header-anchor">#</a> Orphans and widows</h4> <p>In an effort to provide finer influence over page-breaking, CSS2 defines two properties common to both traditional print typography and desktop publishing: widows and orphans.</p> <div class="card" data-v-91de34ec><!----> <!----> <div class="card__property" data-v-91de34ec></div></div> <p>These properties have similar aims but approach them from different angles. The value of widows defines the minimum number of line boxes found in an element that can be placed at the top of a page without forcing a page break to come before the element. orphans has the same effect in reverse: it gives the minimum number of line boxes that can appear at the bottom of a page without forcing a page break before the element.</p> <p>Let’s take widows as an example. Suppose you declare:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">p</span> <span class="token punctuation">{</span>
  <span class="token property">widows</span><span class="token punctuation">:</span> 4<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This means that any paragraph can have no fewer than four line boxes appear at the top of a page. If the layout of the document would lead to fewer line boxes, then the entire paragraph is placed at the top of the page. Consider the situation shown in Figure 20-5. Cover up the top part of the figure with your hand so that only the second page is visible. Notice that there are two line boxes there, from the end of a paragraph that started on the previous page. Given the default widows value of 2, this is an acceptable rendering. However, if the value were 3 or higher, the entire paragraph would appear at the top of the second page as a single block. This would require that a page break be inserted before the paragraph in question.</p> <div class="figure" data-v-87bdcbd6><div class="fg" data-v-87bdcbd6><div class="fgimg" data-v-87bdcbd6><!----> <img src="./figures/ch20/fg20-5.png" data-v-87bdcbd6></div></div> <div class="fgtitle" data-v-87bdcbd6><p data-v-87bdcbd6>
      图 20-5：
      Counting the widows and orphans</p></div></div> <p>Refer back to Figure 20-5, and this time cover up the second page with your hand.</p> <p>Notice the four line boxes at the bottom of the page, at the beginning of the last paragraph. This is fine as long as the value of orphans is 4 or less. If it were 5 or higher, then the paragraph would again be preceded by a page break and be laid out as a single block at the top of the second page.</p> <p>One potential pitfall is that both orphans and widows must be satisfied. If an author declared the following, then most paragraphs would be without an interior page break:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">p</span> <span class="token punctuation">{</span>
  <span class="token property">widows</span><span class="token punctuation">:</span> 30<span class="token punctuation">;</span>
  <span class="token property">orphans</span><span class="token punctuation">:</span> 30<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It would take a pretty lengthy paragraph to allow an interior page break, given those values. If the intent is to prevent interior breaking, then that intent would be better expressed as:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">p</span> <span class="token punctuation">{</span>
  <span class="token property">page-break-inside</span><span class="token punctuation">:</span> avoid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="page-breaking-behavior"><a href="#page-breaking-behavior" class="header-anchor">#</a> Page-breaking behavior</h4> <p>Because CSS2 allows for some odd page-breaking styles, it defines a set of behaviors regarding allowed page breaks and “best” page breaks. These behaviors serve to guide user agents in how they should handle page-breaking in various circumstances.</p> <p>There are really only two generic places where page breaks are permitted. The first of these is between two block-level boxes. If a page break falls between two block boxes, then the margin-bottom value of the element before the page break is reset to 0, as is the margin-top of the element following the page break. However, there are two rules that affect whether a page break can fall between two element boxes:</p> <p>If the value of page-break-after for the first element—or the value of page-breakbefore for the second element—is always, left, or right, then a page break will be placed between the elements. This is true regardless of the value for the other element, even if it’s avoid. (This is a forced page break.)</p> <p>If the value of the first element’s page-break-after value is auto, and the same is true for the second element’s page-break-before value, and they do not share an ancestor element whose page-break-inside value is not avoid, then a page break may be placed between them.</p> <p>Figure 20-6 illustrates all the possible page-break placements between elements in a hypothetical document. Forced page breaks are represented as a filled square, whereas potential (unforced) page breaks are shown as an open square.</p> <p>Second, page breaks are allowed between two line boxes inside a block-level box. This, too, is governed by a pair of rules:</p> <ul><li>A page break may appear between two line boxes only if the number of line boxes between the start of the element and the line box before the page break would be less than the value of orphans for the element. Similarly, a page break can be placed only where the number of line boxes between the line box after the page break and the end of the element is less than the value of widows.</li> <li>A page break can be placed between line boxes if the value of page-breakinside for the element is not avoid.</li></ul> <div class="figure" data-v-87bdcbd6><div class="fg" data-v-87bdcbd6><div class="fgimg" data-v-87bdcbd6><!----> <img src="./figures/ch20/fg20-6.png" data-v-87bdcbd6></div></div> <div class="fgtitle" data-v-87bdcbd6><p data-v-87bdcbd6>
      图 20-6：
      Potential page-break placement between block boxes</p></div></div> <p>In both cases, the second of the two rules controlling page-break placement is ignored if no page-break placement can satisfy all the rules. Thus, given a situation where an element has been given page-break-inside: avoid but the element is longer than a full page, a page break will be permitted inside the element, between two line boxes. In other words, the second rule regarding page-break placement between line boxes is ignored.</p> <p>If ignoring the second rule in each pair of rules still does not yield good page-break placement, then other rules can also be ignored. In such a situation, the user agent is likely to ignore all page-break property values and proceed as if they were all auto, although this approach is not defined (or required) by the CSS specification.</p> <p>In addition to the previously explored rules, CSS2 defines a set of best page-breaking behaviors:</p> <ul><li>Break as few times as possible.</li> <li>Make all pages that don’t end with a forced break appear to have about the same height.</li> <li>Avoid breaking inside a block that has a border.</li> <li>Avoid breaking inside a table.</li> <li>Avoid breaking inside a floated element.</li></ul> <p>These recommendations aren’t required of user agents, but they offer logical guidance that should lead to ideal page-breaking behaviors.</p> <h4 id="repeated-elements"><a href="#repeated-elements" class="header-anchor">#</a> Repeated elements</h4> <p>A very common desire in paged media is the ability to have a running head. This is an element that appears on every page, such as the document’s title or the author’s name. This is possible in CSS2 by using a fixed-position element:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">div#runhead</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This will place any div with an id of runhead at the top-right corner of every page box when the document is output to a paged medium. The same rule would place the element in the top-right corner of the viewport in a continuous medium, such as a web browser. Any element positioned in this way will appear on every page. It is not possible to copy an element to become a repeated element. Thus, given the following, the h1 element will appear as a running head on every page including the first one:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 80%<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid gray<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The drawback is that the h1 element, being positioned on the first page, cannot be printed as anything except the running head.</p> <h4 id="elements-outside-the-page"><a href="#elements-outside-the-page" class="header-anchor">#</a> Elements outside the page</h4> <p>All this talk of positioning elements in a paged medium leads to an interesting question: what happens if an element is positioned outside the page box? You don’t even need positioning to create such a situation. Think about a pre element that contains a line with 411 characters. This is likely to be wider than any standard piece of paper, and so the element will be wider than the page box. What will happen then?</p> <p>As it turns out, CSS2 doesn’t say exactly what user agents should do, so it’s up to each to come up with a solution. For a very wide pre element, the user agent might clip the element to the page box and throw away the rest of the content. It could also generate extra pages to display the leftover part of the element.</p> <p>There are a few general recommendations for handling content outside the page box, and two that are really important. First, content should be allowed to protrude slightly from a page box in order to allow bleeding. This implies that no extra page would be generated for the portions of such content that exceed the page box, but do not extend all the way off the page.</p> <p>Second, user agents are cautioned not to generate large numbers of empty pages for the sole purpose of honoring positioning information. Consider:</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 1500in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Assuming that the page boxes are 10 inches high, the user agent would have to precede an h1 with 150 page breaks (and thus 150 blank pages) just to honor that rule. Instead, a user agent might choose to skip the blank pages and just output the last one, which actually contains the h1 element.</p> <p>The other two recommendations state that user agents should not position elements in strange places just to avoid rendering them, and that content placed outside a page box can be rendered in any of a number of ways. (Some of the commentary in CSS is useful and intriguing, but some seems to exist solely to cheerily state the obvious.)</p> <h2 id="_20-3-summary"><a href="#_20-3-summary" class="header-anchor">#</a> 20.3 Summary</h2> <p>Thanks to the combination of media queries and media-specific style features, it is possible to provide a wide range of design experiences from within a single set of styles. Whether reorganizing a page to account for varying display sizes or reworking the color scheme to support grayscale printing, authors have the ability to do a great deal to make their work the best in can be, no matter what the output channel.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/gdut-yy/CSS-The-Definitive-Guide-4th-zh/edit/master/docs/ch20.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/3/2020, 8:20:49 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/doc/cssdg-4th/ch19.html" class="prev">
        第 19 章 过滤器，混合，剪切和掩蔽 Filters, Blending, Clipping, and Masking
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/doc/cssdg-4th/assets/js/app.22e1f5fa.js" defer></script><script src="/doc/cssdg-4th/assets/js/3.44e73508.js" defer></script><script src="/doc/cssdg-4th/assets/js/25.d563b6d1.js" defer></script><script src="/doc/cssdg-4th/assets/js/7.dcfb28a5.js" defer></script><script src="/doc/cssdg-4th/assets/js/4.624e3ddb.js" defer></script><script src="/doc/cssdg-4th/assets/js/5.2329b135.js" defer></script>
  </body>
</html>
